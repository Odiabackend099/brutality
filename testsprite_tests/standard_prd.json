{
  "meta": {
    "project": "CallWaiting AI Chat Widget",
    "date": "2025-10-17",
    "prepared_by": "Software Development Manager"
  },
  "product_overview": "CallWaiting AI is an advanced AI-powered chat widget integrated with OpenAI GPT-4 and MiniMax Text-to-Speech (TTS) technologies, designed to provide seamless text and voice communication on web platforms. It features a floating bubble chat UI, voice recording, and automated intelligent responses with natural-sounding TTS voice, enhancing user engagement and support experience.",
  "core_goals": [
    "Provide an intuitive and responsive chat interface that supports both text and voice input modes.",
    "Leverage OpenAI GPT-4 AI to deliver intelligent, context-aware, and professional responses to user queries in real-time.",
    "Integrate natural and high-quality TTS voice responses for a more human-like interactive experience.",
    "Offer easy integration and deployment via n8n workflows with ready-to-import AI and TTS processes.",
    "Provide robust error handling, debugging tools, and comprehensive documentation to ensure smooth development, testing, and production deployment.",
    "Ensure mobile responsiveness and cross-browser compatibility with secure, scalable infrastructure."
  ],
  "key_features": [
    "Floating bubble chat button that expands into a full chat window on interaction.",
    "Dual input modes: text chat and voice recording with a visible recording timer.",
    "AI-powered intelligent text responses using OpenAI GPT-4o-mini for concise and professional replies.",
    "Voice responses generated by MiniMax TTS API with configurable natural female voice and auto-play audio.",
    "Smooth animations and beautiful gradient UI for enhanced user experience.",
    "Comprehensive n8n workflows to handle webhook triggers, AI processing, TTS generation, and audio URL delivery.",
    "Testing tools including command-line webhook tester (`test-webhook.js`) and browser console logging.",
    "Complete documentation suite covering setup, configuration, troubleshooting, production deployment, and usage tips.",
    "Security best practices including API key management, CORS restrictions, and input validation.",
    "Mobile responsive design with fast performance and error-free operation across major browsers."
  ],
  "user_flow_summary": [
    "User visits website and sees a floating chat widget bubble.",
    "User clicks the bubble to expand the chat window, choosing text or voice input mode.",
    "For text input, user types a message and sends it; for voice input, user records a message and stops recording to send.",
    "The widget sends the user message as a webhook POST to the n8n workflow endpoint.",
    "n8n workflow triggers OpenAI GPT-4 to generate an intelligent text response based on the conversation.",
    "The text response is sent to the MiniMax TTS API workflow node to create a high-quality audio response URL.",
    "The combined AI text response and audio URL are returned in JSON format to the chat widget.",
    "The widget displays the AI text reply and auto-plays the received audio response to the user.",
    "User can continue conversation, switching input modes as desired, with smooth UI transitions.",
    "If errors occur, the widget displays appropriate messages and logs details for debugging."
  ],
  "validation_criteria": [
    "Chat widget renders properly on desktop and mobile devices with no visual or functional defects.",
    "Text message sending triggers AI response within 3 seconds with accurate and context-aware replies.",
    "Voice recording captures and transmits user audio correctly and triggers TTS audio response playback.",
    "Webhook tester (`test-webhook.js`) passes with expected JSON output containing text and audio_url fields.",
    "n8n workflows import without errors and execute sequentially for webhook, AI generation, and TTS processes.",
    "Security checks confirm no exposure of API keys, input validation in place, and CORS policies enforced.",
    "UI components such as loading indicators, error boundaries, and animations operate smoothly without crashes.",
    "Comprehensive documentation reviewed for completeness and clarity to assist deployment and troubleshooting.",
    "Production deployment includes HTTPS enforcement, rate limiting, and environment variable configuration.",
    "Cross-browser and device testing confirms consistent experience, audio playback compatibility, and responsiveness."
  ],
  "code_summary": {
    "tech_stack": [
      "TypeScript",
      "Next.js 14",
      "React 18",
      "Tailwind CSS",
      "Supabase",
      "ODIADEV AI TTS",
      "Twilio",
      "Flutterwave",
      "Vercel",
      "n8n Workflows"
    ],
    "features": [
      {
        "name": "Landing Page",
        "description": "High-converting landing page with hero section, demo video, pricing, and CTAs",
        "files": [
          "app/page.tsx",
          "app/layout.tsx",
          "app/globals.css"
        ]
      },
      {
        "name": "Authentication System",
        "description": "Complete auth system with login, signup, password reset, and session management",
        "files": [
          "app/login/page.tsx",
          "app/signup/page.tsx",
          "app/auth/callback/route.ts",
          "app/forgot-password/page.tsx",
          "app/auth/reset-password/page.tsx",
          "lib/auth-helpers.ts"
        ]
      },
      {
        "name": "Dashboard",
        "description": "Protected dashboard with agents, calls, flows, leads, payments, phone, and settings management",
        "files": [
          "app/dashboard/page.tsx",
          "app/dashboard/layout.tsx",
          "app/dashboard/agents/page.tsx",
          "app/dashboard/calls/page.tsx",
          "app/dashboard/flows/page.tsx",
          "app/dashboard/leads/page.tsx",
          "app/dashboard/payments/page.tsx",
          "app/dashboard/phone/page.tsx",
          "app/dashboard/settings/page.tsx",
          "app/dashboard/upgrade/page.tsx"
        ]
      },
      {
        "name": "AI Agent Management",
        "description": "Create, manage, and test AI voice agents with custom prompts and voice selection",
        "files": [
          "app/api/create-agent/route.ts",
          "app/api/agent/[id]/webhook/route.ts",
          "app/agent/[id]/page.tsx",
          "components/CreateAgentModal.tsx",
          "components/QuickAgentTest.tsx"
        ]
      },
      {
        "name": "Voice & TTS Integration",
        "description": "Text-to-speech generation using ODIADEV AI TTS with multiple voice options",
        "files": [
          "lib/odiadev-tts.ts",
          "app/api/generate-voice/route.ts",
          "components/VoiceChat.tsx",
          "components/VoiceRecorder.tsx"
        ]
      },
      {
        "name": "Call Management",
        "description": "Handle inbound calls, call completion, status tracking, and transcript processing",
        "files": [
          "app/api/call/inbound/route.ts",
          "app/api/call/complete/route.ts",
          "app/api/call/check-trial/route.ts",
          "app/api/twilio/call-status/route.ts",
          "app/api/twilio/transcript/route.ts"
        ]
      },
      {
        "name": "Lead Capture & Delivery",
        "description": "Extract lead information from calls and deliver via WhatsApp or email",
        "files": [
          "app/api/leads/extract/route.ts",
          "app/api/leads/deliver/route.ts",
          "app/api/whatsapp/send/route.ts"
        ]
      },
      {
        "name": "Free Trial System",
        "description": "5-minute free trial management with usage tracking and upgrade prompts",
        "files": [
          "lib/free-trial.ts",
          "app/api/trial/status/route.ts",
          "app/api/trial/record-usage/route.ts",
          "components/TrialStatusBanner.tsx",
          "components/UsageQuota.tsx"
        ]
      },
      {
        "name": "Payment Integration",
        "description": "Flutterwave payment processing for subscription plans and one-time payments",
        "files": [
          "app/api/create-payment-link/route.ts",
          "app/api/flutterwave-webhook/route.ts",
          "app/billing/page.tsx",
          "components/PricingSection.tsx",
          "lib/flutterwave.ts"
        ]
      },
      {
        "name": "Chat Widget",
        "description": "Floating chat widget with voice and text input for customer support",
        "files": [
          "components/ChatWidget.tsx",
          "app/api/chat/widget/route.ts",
          "app/chat-widget.css",
          "hooks/useChat.ts"
        ]
      },
      {
        "name": "UI Components",
        "description": "Reusable UI components including logo, loading states, error handling, and admin panel",
        "files": [
          "components/Logo.tsx",
          "components/LoadingSkeleton.tsx",
          "components/ErrorBoundary.tsx",
          "components/TestAdminPanel.tsx",
          "components/CallAgentButton.tsx"
        ]
      },
      {
        "name": "API Health & Monitoring",
        "description": "Health checks, usage reporting, and admin testing endpoints",
        "files": [
          "app/api/health/route.ts",
          "app/api/usage-report/route.ts",
          "app/api/admin/test-create/route.ts"
        ]
      },
      {
        "name": "Static Pages",
        "description": "Privacy policy, terms of service, contact, and success pages",
        "files": [
          "app/privacy/page.tsx",
          "app/terms/page.tsx",
          "app/contact/page.tsx",
          "app/success/page.tsx"
        ]
      }
    ]
  }
}
